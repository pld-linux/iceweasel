--- iceweasel-32.0.3/mozilla/browser/installer/package-manifest.in~	2014-09-24 03:05:09.000000000 +0200
+++ iceweasel-32.0.3/mozilla/browser/installer/package-manifest.in	2014-09-28 03:16:25.047988707 +0200
@@ -32,14 +32,18 @@
 [@AB_CD@]
 @BINPATH@/browser/chrome/@AB_CD@@JAREXT@
 @BINPATH@/browser/chrome/@AB_CD@.manifest
+#ifndef LIBXUL_SDK
 @BINPATH@/chrome/@AB_CD@@JAREXT@
 @BINPATH@/chrome/@AB_CD@.manifest
+#endif
 @BINPATH@/browser/defaults/profile/bookmarks.html
 @BINPATH@/browser/defaults/profile/chrome/*
 @BINPATH@/browser/defaults/profile/localstore.rdf
 @BINPATH@/browser/defaults/profile/mimeTypes.rdf
+#ifndef LIBXUL_SDK
 @BINPATH@/dictionaries/*
 @BINPATH@/hyphenation/*
+#endif
 @BINPATH@/browser/@PREF_DIR@/firefox-l10n.js
 @BINPATH@/browser/searchplugins/*
 #ifdef XP_WIN32
@@ -51,17 +55,23 @@
 #endif
 
 [xpcom]
+#ifndef LIBXUL_SDK
 @BINPATH@/dependentlibs.list
+#endif
 #ifdef GKMEDIAS_SHARED_LIBRARY
 @BINPATH@/@DLL_PREFIX@gkmedias@DLL_SUFFIX@
 #endif
+#ifndef LIBXUL_SDK
 @BINPATH@/@DLL_PREFIX@mozalloc@DLL_SUFFIX@
+#endif
 #ifdef MOZ_SHARED_MOZGLUE
 @BINPATH@/@DLL_PREFIX@mozglue@DLL_SUFFIX@
 #endif
 #ifndef MOZ_STATIC_JS
+#ifndef LIBXUL_SDK
 @BINPATH@/@DLL_PREFIX@mozjs@DLL_SUFFIX@
 #endif
+#endif
 #ifdef MOZ_DMD
 @BINPATH@/@DLL_PREFIX@dmd@DLL_SUFFIX@
 #endif
@@ -75,14 +85,18 @@
 #ifdef XP_MACOSX
 @BINPATH@/XUL
 #else
+#ifndef LIBXUL_SDK
 @BINPATH@/@DLL_PREFIX@xul@DLL_SUFFIX@
 #endif
+#endif
 #ifdef XP_MACOSX
 @BINPATH@/@MOZ_CHILD_PROCESS_NAME@.app/
 @BINPATH@/@DLL_PREFIX@plugin_child_interpose@DLL_SUFFIX@
 #else
+#ifndef LIBXUL_SDK
 @BINPATH@/@MOZ_CHILD_PROCESS_NAME@
 #endif
+#endif
 #ifdef XP_WIN32
 @BINPATH@/plugin-hang-ui@BIN_SUFFIX@
 #if MOZ_MSVC_REDIST == 1600
@@ -135,7 +149,9 @@
 #ifdef MOZ_UPDATER
 @BINPATH@/update-settings.ini
 #endif
+#ifndef LIBXUL_SDK
 @BINPATH@/platform.ini
+#endif
 #ifndef MOZ_NATIVE_SQLITE
 #ifndef MOZ_FOLD_LIBS
 @BINPATH@/@DLL_PREFIX@mozsqlite3@DLL_SUFFIX@
@@ -145,12 +161,15 @@
 #ifdef XP_UNIX
 #ifndef XP_MACOSX
 @BINPATH@/run-mozilla.sh
+#ifndef LIBXUL_SDK
 @BINPATH@/mozilla-xremote-client
 #endif
 #endif
+#endif
 
 ; [Components]
 @BINPATH@/browser/components/components.manifest
+#ifndef LIBXUL_SDK
 @BINPATH@/components/alerts.xpt
 #ifdef ACCESSIBILITY
 #ifdef XP_WIN32
@@ -162,8 +181,10 @@
 @BINPATH@/components/appstartup.xpt
 @BINPATH@/components/autocomplete.xpt
 @BINPATH@/components/autoconfig.xpt
+#endif
 @BINPATH@/browser/components/browsercompsbase.xpt
 @BINPATH@/browser/components/browser-feeds.xpt
+#ifndef LIBXUL_SDK
 @BINPATH@/components/caps.xpt
 @BINPATH@/components/chrome.xpt
 @BINPATH@/components/commandhandler.xpt
@@ -238,7 +259,9 @@
 @BINPATH@/components/filepicker.xpt
 #endif
 @BINPATH@/components/find.xpt
+#endif
 @BINPATH@/browser/components/fuel.xpt
+#ifndef LIBXUL_SDK
 @BINPATH@/components/gfx.xpt
 @BINPATH@/components/html5.xpt
 @BINPATH@/components/htmlparser.xpt
@@ -262,7 +285,9 @@
 @BINPATH@/components/layout_xul.xpt
 @BINPATH@/components/locale.xpt
 @BINPATH@/components/lwbrk.xpt
+#endif
 @BINPATH@/browser/components/migration.xpt
+#ifndef LIBXUL_SDK
 @BINPATH@/components/mimetype.xpt
 @BINPATH@/components/mozfind.xpt
 @BINPATH@/components/necko_about.xpt
@@ -299,12 +324,16 @@
 @BINPATH@/components/rdf.xpt
 @BINPATH@/components/satchel.xpt
 @BINPATH@/components/saxparser.xpt
+#endif
 @BINPATH@/browser/components/sessionstore.xpt
+#ifndef LIBXUL_SDK
 @BINPATH@/components/services-crypto-component.xpt
 #ifdef MOZ_CAPTIVEDETECT
 @BINPATH@/components/captivedetect.xpt
 #endif
+#endif
 @BINPATH@/browser/components/shellservice.xpt
+#ifndef LIBXUL_SDK
 @BINPATH@/components/shistory.xpt
 @BINPATH@/components/spellchecker.xpt
 @BINPATH@/components/storage.xpt
@@ -343,8 +372,10 @@
 @BINPATH@/components/xultmpl.xpt
 @BINPATH@/components/zipwriter.xpt
 @BINPATH@/components/telemetry.xpt
+#endif
 
 ; JavaScript components
+#ifndef LIBXUL_SDK
 @BINPATH@/components/ChromeNotifications.js
 @BINPATH@/components/ChromeNotifications.manifest
 @BINPATH@/components/ConsoleAPI.manifest
@@ -353,6 +384,7 @@
 @BINPATH@/components/BrowserElementParent.js
 @BINPATH@/components/FeedProcessor.manifest
 @BINPATH@/components/FeedProcessor.js
+#endif
 @BINPATH@/browser/components/BrowserFeeds.manifest
 @BINPATH@/browser/components/FeedConverter.js
 @BINPATH@/browser/components/FeedWriter.js
@@ -373,6 +405,7 @@
 @BINPATH@/browser/components/Experiments.manifest
 @BINPATH@/browser/components/ExperimentsService.js
 @BINPATH@/browser/components/translation.manifest
+#ifndef LIBXUL_SDK
 @BINPATH@/components/Downloads.manifest
 @BINPATH@/components/DownloadLegacy.js
 @BINPATH@/components/BrowserPageThumbs.manifest
@@ -404,8 +437,10 @@
 @BINPATH@/components/nsDownloadManagerUI.js
 @BINPATH@/components/NetworkGeolocationProvider.manifest
 @BINPATH@/components/NetworkGeolocationProvider.js
+#endif
 @BINPATH@/browser/components/nsSidebar.manifest
 @BINPATH@/browser/components/nsSidebar.js
+#ifndef LIBXUL_SDK
 @BINPATH@/components/extensions.manifest
 @BINPATH@/components/addonManager.js
 @BINPATH@/components/amContentHandler.js
@@ -420,12 +455,16 @@
 @BINPATH@/components/nsUpdateTimerManager.manifest
 @BINPATH@/components/nsUpdateTimerManager.js
 @BINPATH@/components/pluginGlue.manifest
+#endif
 @BINPATH@/browser/components/nsSessionStore.manifest
 @BINPATH@/browser/components/nsSessionStartup.js
 @BINPATH@/browser/components/nsSessionStore.js
+#ifndef LIBXUL_SDK
 @BINPATH@/components/nsURLFormatter.manifest
 @BINPATH@/components/nsURLFormatter.js
+#endif
 @BINPATH@/browser/components/@DLL_PREFIX@browsercomps@DLL_SUFFIX@
+#ifndef LIBXUL_SDK
 @BINPATH@/components/txEXSLTRegExFunctions.manifest
 @BINPATH@/components/txEXSLTRegExFunctions.js
 @BINPATH@/components/toolkitplaces.manifest
@@ -436,7 +475,9 @@
 @BINPATH@/components/UnifiedComplete.manifest
 @BINPATH@/components/UnifiedComplete.js
 @BINPATH@/components/nsPlacesExpiration.js
+#endif
 @BINPATH@/browser/components/PlacesProtocolHandler.js
+#ifndef LIBXUL_SDK
 @BINPATH@/components/PlacesCategoriesStarter.js
 @BINPATH@/components/ColorAnalyzer.js
 @BINPATH@/components/PageThumbsProtocol.js
@@ -461,6 +502,7 @@
 @BINPATH@/components/contentSecurityPolicy.js
 @BINPATH@/components/contentAreaDropListener.manifest
 @BINPATH@/components/contentAreaDropListener.js
+#endif
 @BINPATH@/browser/components/BrowserProfileMigrators.manifest
 @BINPATH@/browser/components/ProfileMigrator.js
 @BINPATH@/browser/components/ChromeProfileMigrator.js
@@ -472,6 +514,7 @@
 #ifdef XP_MACOSX
 @BINPATH@/browser/components/SafariProfileMigrator.js
 #endif
+#ifndef LIBXUL_SDK
 #ifdef MOZ_ENABLE_DBUS
 @BINPATH@/components/@DLL_PREFIX@dbusservice@DLL_SUFFIX@
 #endif
@@ -588,19 +631,24 @@
 @BINPATH@/components/TestInterfaceJS.js
 @BINPATH@/components/TestInterfaceJS.manifest
 #endif
+#endif
 
 ; Modules
 @BINPATH@/browser/modules/*
+#ifndef LIBXUL_SDK
 @BINPATH@/modules/*
+#endif
 
 ; Safe Browsing
 #ifdef MOZ_URL_CLASSIFIER
+#ifndef LIBXUL_SDK
 @BINPATH@/components/nsURLClassifier.manifest
 @BINPATH@/components/nsUrlClassifierHashCompleter.js
 @BINPATH@/components/nsUrlClassifierListManager.js
 @BINPATH@/components/nsUrlClassifierLib.js
 @BINPATH@/components/url-classifier.xpt
 #endif
+#endif
 
 ; ANGLE GLES-on-D3D rendering library
 #ifdef MOZ_ANGLE_RENDERER
@@ -628,10 +676,12 @@
 #endif
 @BINPATH@/browser/extensions/{972ce4c6-7e08-4474-a285-3208198ce6fd}/install.rdf
 @BINPATH@/browser/extensions/{972ce4c6-7e08-4474-a285-3208198ce6fd}/icon.png
+#ifndef LIBXUL_SDK
 @BINPATH@/chrome/toolkit@JAREXT@
 @BINPATH@/chrome/toolkit.manifest
 @BINPATH@/chrome/recording.manifest
 @BINPATH@/chrome/recording/*
+#endif
 #ifdef MOZ_GTK
 @BINPATH@/browser/chrome/icons/default/default16.png
 @BINPATH@/browser/chrome/icons/default/default32.png
@@ -661,9 +711,11 @@
 ; All the pref files must be part of base to prevent migration bugs
 @BINPATH@/browser/@PREF_DIR@/firefox.js
 @BINPATH@/browser/@PREF_DIR@/firefox-branding.js
+#ifndef LIBXUL_SDK
 @BINPATH@/greprefs.js
 @BINPATH@/defaults/autoconfig/platform.js
 @BINPATH@/defaults/autoconfig/prefcalls.js
+#endif
 @BINPATH@/browser/defaults/profile/prefs.js
 
 #ifndef LIBXUL_SDK
@@ -673,7 +725,7 @@
 @BINPATH@/defaults/pref/channel-prefs.js
 #else
 ; For Fx-on-xr, channel-prefs lives with the app preferences. (Bug 762588)
-@BINPATH@/@PREF_DIR@/channel-prefs.js
+@BINPATH@/browser/@PREF_DIR@/channel-prefs.js
 #endif
 
 ; Services (gre) prefs
@@ -681,11 +733,14 @@
 @BINPATH@/defaults/pref/services-notifications.js
 #endif
 #ifdef MOZ_SERVICES_SYNC
+#ifndef LIBXUL_SDK
 @BINPATH@/defaults/pref/services-sync.js
 #endif
+#endif
 
 ; [Layout Engine Resources]
 ; Style Sheets, Graphics and other Resources used by the layout engine.
+#ifndef LIBXUL_SDK
 @BINPATH@/res/EditorOverride.css
 @BINPATH@/res/contenteditable.css
 @BINPATH@/res/designmode.css
@@ -723,11 +778,14 @@
 #ifdef XP_MACOSX
 @BINPATH@/res/MainMenu.nib/
 #endif
+#endif
 
 ; svg
+#ifndef LIBXUL_SDK
 @BINPATH@/res/svg.css
 @BINPATH@/components/dom_svg.xpt
 @BINPATH@/components/dom_smil.xpt
+#endif
 
 ; [Personal Security Manager]
 ;
@@ -748,11 +806,13 @@
 #endif
 @BINPATH@/@DLL_PREFIX@softokn3@DLL_SUFFIX@
 #endif
+#ifndef LIBXUL_SDK
 @BINPATH@/chrome/pippki@JAREXT@
 @BINPATH@/chrome/pippki.manifest
 @BINPATH@/components/pipboot.xpt
 @BINPATH@/components/pipnss.xpt
 @BINPATH@/components/pippki.xpt
+#endif
 
 ; For content sandboxing
 #if defined(XP_WIN) && defined(MOZ_CONTENT_SANDBOX)
@@ -859,9 +919,11 @@
 @BINPATH@/metro/modules
 #endif
 
+#ifndef LIBXUL_SDK
 @BINPATH@/components/DataStore.manifest
 @BINPATH@/components/DataStoreImpl.js
 @BINPATH@/components/dom_datastore.xpt
+#endif
 
 
 #ifdef MOZ_ASAN
