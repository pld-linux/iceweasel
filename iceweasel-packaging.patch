diff -ruN mozilla-release.orig/browser/installer/package-manifest.in mozilla-release/browser/installer/package-manifest.in
--- mozilla-release.orig/browser/installer/package-manifest.in	2015-01-09 05:38:16.000000000 +0100
+++ mozilla-release/browser/installer/package-manifest.in	2015-01-24 14:11:47.692555975 +0100
@@ -31,14 +31,18 @@
 [@AB_CD@]
 @BINPATH@/browser/chrome/@AB_CD@@JAREXT@
 @BINPATH@/browser/chrome/@AB_CD@.manifest
+#ifndef LIBXUL_SDK
 @BINPATH@/chrome/@AB_CD@@JAREXT@
 @BINPATH@/chrome/@AB_CD@.manifest
+#endif
 @BINPATH@/browser/defaults/profile/bookmarks.html
 @BINPATH@/browser/defaults/profile/chrome/*
 @BINPATH@/browser/defaults/profile/localstore.rdf
 @BINPATH@/browser/defaults/profile/mimeTypes.rdf
+#ifndef LIBXUL_SDK
 @BINPATH@/dictionaries/*
 @BINPATH@/hyphenation/*
+#endif
 @BINPATH@/browser/@PREF_DIR@/firefox-l10n.js
 @BINPATH@/browser/searchplugins/*
 #ifdef XP_WIN32
@@ -50,15 +54,19 @@
 #endif
 
 [xpcom]
+#ifndef LIBXUL_SDK
 @BINPATH@/dependentlibs.list
+#endif
 #ifdef GKMEDIAS_SHARED_LIBRARY
 @BINPATH@/@DLL_PREFIX@gkmedias@DLL_SUFFIX@
 #endif
+#ifndef LIBXUL_SDK
 #ifdef XP_MACOSX
 @APPNAME@/Contents/MacOS/@DLL_PREFIX@mozalloc@DLL_SUFFIX@
 #else
 @BINPATH@/@DLL_PREFIX@mozalloc@DLL_SUFFIX@
 #endif
+#endif
 #ifdef MOZ_SHARED_MOZGLUE
 #ifdef XP_MACOSX
 @APPNAME@/Contents/MacOS/@DLL_PREFIX@mozglue@DLL_SUFFIX@
@@ -67,12 +75,14 @@
 #endif
 #endif
 #ifndef MOZ_STATIC_JS
+#ifndef LIBXUL_SDK
 #ifdef XP_MACOSX
 @APPNAME@/Contents/MacOS/@DLL_PREFIX@mozjs@DLL_SUFFIX@
 #else
 @BINPATH@/@DLL_PREFIX@mozjs@DLL_SUFFIX@
 #endif
 #endif
+#endif
 #ifdef MOZ_DMD
 #ifdef XP_MACOSX
 @APPNAME@/Contents/MacOS/@DLL_PREFIX@dmd@DLL_SUFFIX@
@@ -90,14 +100,18 @@
 #ifdef XP_MACOSX
 @APPNAME@/Contents/MacOS/XUL
 #else
+#ifndef LIBXUL_SDK
 @BINPATH@/@DLL_PREFIX@xul@DLL_SUFFIX@
 #endif
+#endif
 #ifdef XP_MACOSX
 @APPNAME@/Contents/MacOS/@MOZ_CHILD_PROCESS_NAME@.app/
 @APPNAME@/Contents/MacOS/@DLL_PREFIX@plugin_child_interpose@DLL_SUFFIX@
 #else
+#ifndef LIBXUL_SDK
 @BINPATH@/@MOZ_CHILD_PROCESS_NAME@
 #endif
+#endif
 #ifdef XP_WIN32
 @BINPATH@/plugin-hang-ui@BIN_SUFFIX@
 #if MOZ_PACKAGE_MSVC_DLLS
@@ -151,7 +165,9 @@
 #ifdef MOZ_UPDATER
 @BINPATH@/update-settings.ini
 #endif
+#ifndef LIBXUL_SDK
 @BINPATH@/platform.ini
+#endif
 #ifndef MOZ_NATIVE_SQLITE
 #ifndef MOZ_FOLD_LIBS
 @BINPATH@/@DLL_PREFIX@mozsqlite3@DLL_SUFFIX@
@@ -161,12 +177,15 @@
 #ifdef XP_UNIX
 #ifndef XP_MACOSX
 @BINPATH@/run-mozilla.sh
+#ifndef LIBXUL_SDK
 @BINPATH@/mozilla-xremote-client
 #endif
 #endif
+#endif
 
 ; [Components]
 @BINPATH@/browser/components/components.manifest
+#ifndef LIBXUL_SDK
 @BINPATH@/components/alerts.xpt
 #ifdef ACCESSIBILITY
 #ifdef XP_WIN32
@@ -178,9 +197,11 @@
 @BINPATH@/components/appstartup.xpt
 @BINPATH@/components/autocomplete.xpt
 @BINPATH@/components/autoconfig.xpt
+#endif
 @BINPATH@/browser/components/browsercompsbase.xpt
 @BINPATH@/browser/components/browser-feeds.xpt
 @BINPATH@/browser/components/browsermodules.manifest
+#ifndef LIBXUL_SDK
 @BINPATH@/components/caps.xpt
 @BINPATH@/components/chrome.xpt
 @BINPATH@/components/commandhandler.xpt
@@ -258,7 +279,9 @@
 @BINPATH@/components/filepicker.xpt
 #endif
 @BINPATH@/components/find.xpt
+#endif
 @BINPATH@/browser/components/fuel.xpt
+#ifndef LIBXUL_SDK
 @BINPATH@/components/gfx.xpt
 @BINPATH@/components/html5.xpt
 @BINPATH@/components/htmlparser.xpt
@@ -279,7 +302,9 @@
 @BINPATH@/components/layout_xul.xpt
 @BINPATH@/components/locale.xpt
 @BINPATH@/components/lwbrk.xpt
+#endif
 @BINPATH@/browser/components/migration.xpt
+#ifndef LIBXUL_SDK
 @BINPATH@/components/mimetype.xpt
 @BINPATH@/components/mozfind.xpt
 @BINPATH@/components/necko_about.xpt
@@ -316,12 +341,16 @@
 @BINPATH@/components/rdf.xpt
 @BINPATH@/components/satchel.xpt
 @BINPATH@/components/saxparser.xpt
+#endif
 @BINPATH@/browser/components/sessionstore.xpt
+#ifndef LIBXUL_SDK
 @BINPATH@/components/services-crypto-component.xpt
 #ifdef MOZ_CAPTIVEDETECT
 @BINPATH@/components/captivedetect.xpt
 #endif
+#endif
 @BINPATH@/browser/components/shellservice.xpt
+#ifndef LIBXUL_SDK
 @BINPATH@/components/shistory.xpt
 @BINPATH@/components/spellchecker.xpt
 @BINPATH@/components/storage.xpt
@@ -364,8 +393,10 @@
 @BINPATH@/components/xultmpl.xpt
 @BINPATH@/components/zipwriter.xpt
 @BINPATH@/components/telemetry.xpt
+#endif
 
 ; JavaScript components
+#ifndef LIBXUL_SDK
 @BINPATH@/components/ChromeNotifications.js
 @BINPATH@/components/ChromeNotifications.manifest
 @BINPATH@/components/ConsoleAPI.manifest
@@ -374,6 +405,7 @@
 @BINPATH@/components/BrowserElementParent.js
 @BINPATH@/components/FeedProcessor.manifest
 @BINPATH@/components/FeedProcessor.js
+#endif
 @BINPATH@/browser/components/BrowserFeeds.manifest
 @BINPATH@/browser/components/FeedConverter.js
 @BINPATH@/browser/components/FeedWriter.js
@@ -396,6 +428,7 @@
 @BINPATH@/browser/components/Experiments.manifest
 @BINPATH@/browser/components/ExperimentsService.js
 @BINPATH@/browser/components/translation.manifest
+#ifndef LIBXUL_SDK
 @BINPATH@/components/Downloads.manifest
 @BINPATH@/components/DownloadLegacy.js
 @BINPATH@/components/BrowserPageThumbs.manifest
@@ -427,8 +460,10 @@
 @BINPATH@/components/nsDownloadManagerUI.js
 @BINPATH@/components/NetworkGeolocationProvider.manifest
 @BINPATH@/components/NetworkGeolocationProvider.js
+#endif
 @BINPATH@/browser/components/nsSidebar.manifest
 @BINPATH@/browser/components/nsSidebar.js
+#ifndef LIBXUL_SDK
 @BINPATH@/components/extensions.manifest
 @BINPATH@/components/addonManager.js
 @BINPATH@/components/amContentHandler.js
@@ -448,12 +483,16 @@
 @BINPATH@/components/ProcessSingleton.manifest
 @BINPATH@/components/MainProcessSingleton.js
 @BINPATH@/components/ContentProcessSingleton.js
+#endif
 @BINPATH@/browser/components/nsSessionStore.manifest
 @BINPATH@/browser/components/nsSessionStartup.js
 @BINPATH@/browser/components/nsSessionStore.js
+#ifndef LIBXUL_SDK
 @BINPATH@/components/nsURLFormatter.manifest
 @BINPATH@/components/nsURLFormatter.js
+#endif
 @BINPATH@/browser/components/@DLL_PREFIX@browsercomps@DLL_SUFFIX@
+#ifndef LIBXUL_SDK
 @BINPATH@/components/txEXSLTRegExFunctions.manifest
 @BINPATH@/components/txEXSLTRegExFunctions.js
 @BINPATH@/components/toolkitplaces.manifest
@@ -464,7 +503,9 @@
 @BINPATH@/components/UnifiedComplete.manifest
 @BINPATH@/components/UnifiedComplete.js
 @BINPATH@/components/nsPlacesExpiration.js
+#endif
 @BINPATH@/browser/components/PlacesProtocolHandler.js
+#ifndef LIBXUL_SDK
 @BINPATH@/components/PlacesCategoriesStarter.js
 @BINPATH@/components/ColorAnalyzer.js
 @BINPATH@/components/PageThumbsProtocol.js
@@ -488,6 +529,7 @@
 @BINPATH@/components/FormAutofillStartup.js
 @BINPATH@/components/contentAreaDropListener.manifest
 @BINPATH@/components/contentAreaDropListener.js
+#endif
 @BINPATH@/browser/components/BrowserProfileMigrators.manifest
 @BINPATH@/browser/components/ProfileMigrator.js
 @BINPATH@/browser/components/ChromeProfileMigrator.js
@@ -499,6 +541,7 @@
 #ifdef XP_MACOSX
 @BINPATH@/browser/components/SafariProfileMigrator.js
 #endif
+#ifndef LIBXUL_SDK
 #ifdef MOZ_ENABLE_DBUS
 @BINPATH@/components/@DLL_PREFIX@dbusservice@DLL_SUFFIX@
 #endif
@@ -622,19 +665,24 @@
 @BINPATH@/components/TestInterfaceJS.js
 @BINPATH@/components/TestInterfaceJS.manifest
 #endif
+#endif
 
 ; Modules
 @BINPATH@/browser/modules/*
+#ifndef LIBXUL_SDK
 @BINPATH@/modules/*
+#endif
 
 ; Safe Browsing
 #ifdef MOZ_URL_CLASSIFIER
+#ifndef LIBXUL_SDK
 @BINPATH@/components/nsURLClassifier.manifest
 @BINPATH@/components/nsUrlClassifierHashCompleter.js
 @BINPATH@/components/nsUrlClassifierListManager.js
 @BINPATH@/components/nsUrlClassifierLib.js
 @BINPATH@/components/url-classifier.xpt
 #endif
+#endif
 
 ; ANGLE GLES-on-D3D rendering library
 #ifdef MOZ_ANGLE_RENDERER
@@ -662,10 +710,12 @@
 #endif
 @BINPATH@/browser/extensions/{972ce4c6-7e08-4474-a285-3208198ce6fd}/install.rdf
 @BINPATH@/browser/extensions/{972ce4c6-7e08-4474-a285-3208198ce6fd}/icon.png
+#ifndef LIBXUL_SDK
 @BINPATH@/chrome/toolkit@JAREXT@
 @BINPATH@/chrome/toolkit.manifest
 @BINPATH@/chrome/recording.manifest
 @BINPATH@/chrome/recording/*
+#endif
 #ifdef MOZ_GTK
 @BINPATH@/browser/chrome/icons/default/default16.png
 @BINPATH@/browser/chrome/icons/default/default32.png
@@ -693,9 +743,11 @@
 ; All the pref files must be part of base to prevent migration bugs
 @BINPATH@/browser/@PREF_DIR@/firefox.js
 @BINPATH@/browser/@PREF_DIR@/firefox-branding.js
+#ifndef LIBXUL_SDK
 @BINPATH@/greprefs.js
 @BINPATH@/defaults/autoconfig/platform.js
 @BINPATH@/defaults/autoconfig/prefcalls.js
+#endif
 @BINPATH@/browser/defaults/profile/prefs.js
 
 #ifndef LIBXUL_SDK
@@ -705,7 +757,7 @@
 @BINPATH@/defaults/pref/channel-prefs.js
 #else
 ; For Fx-on-xr, channel-prefs lives with the app preferences. (Bug 762588)
-@BINPATH@/@PREF_DIR@/channel-prefs.js
+@BINPATH@/browser/@PREF_DIR@/channel-prefs.js
 #endif
 
 ; Services (gre) prefs
@@ -713,11 +765,14 @@
 @BINPATH@/defaults/pref/services-notifications.js
 #endif
 #ifdef MOZ_SERVICES_SYNC
+#ifndef LIBXUL_SDK
 @BINPATH@/defaults/pref/services-sync.js
 #endif
+#endif
 
 ; [Layout Engine Resources]
 ; Style Sheets, Graphics and other Resources used by the layout engine.
+#ifndef LIBXUL_SDK
 @BINPATH@/res/EditorOverride.css
 @BINPATH@/res/contenteditable.css
 @BINPATH@/res/designmode.css
@@ -755,11 +810,14 @@
 #ifdef XP_MACOSX
 @BINPATH@/res/MainMenu.nib/
 #endif
+#endif
 
 ; svg
+#ifndef LIBXUL_SDK
 @BINPATH@/res/svg.css
 @BINPATH@/components/dom_svg.xpt
 @BINPATH@/components/dom_smil.xpt
+#endif
 
 ; [Personal Security Manager]
 ;
@@ -794,11 +852,13 @@
 @BINPATH@/@DLL_PREFIX@softokn3@DLL_SUFFIX@
 #endif
 #endif
+#ifndef LIBXUL_SDK
 @BINPATH@/chrome/pippki@JAREXT@
 @BINPATH@/chrome/pippki.manifest
 @BINPATH@/components/pipboot.xpt
 @BINPATH@/components/pipnss.xpt
 @BINPATH@/components/pippki.xpt
+#endif
 
 ; For process sandboxing
 #if defined(MOZ_SANDBOX)
@@ -913,9 +973,11 @@
 @BINPATH@/metro/modules
 #endif
 
+#ifndef LIBXUL_SDK
 @BINPATH@/components/DataStore.manifest
 @BINPATH@/components/DataStoreImpl.js
 @BINPATH@/components/dom_datastore.xpt
+#endif
 
 
 #ifdef MOZ_ASAN
